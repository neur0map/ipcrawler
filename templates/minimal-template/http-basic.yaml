metadata:
  name: "Basic HTTP Service Scan"
  description: "Simple HTTP service enumeration"
  type: "servicescan"
  priority: 10
  version: "1.0"
  author: "IPCrawler Template System"
  tags: ["default", "safe", "web"]

conditions:
  services:
    include: ["^http", "ssl/http", "^https"]
    exclude: ["^nacn_http$"]

execution:
  commands:
    - name: "http_headers"
      command: "curl -I -s {http_scheme}://{hostname}:{port}/"
      timeout: 30
      description: "Get HTTP headers"

output:
  patterns:
    - pattern: "Server:\\\\s*(.+)"
      description: "Web server: {match1}"
      severity: "info"
      category: "service_identification"
    - pattern: "X-Powered-By:\\\\s*(.+)"
      description: "Technology: {match1}"
      severity: "info"
      category: "technology_detection"

requirements:
  tools:
    - name: "curl"
      check_command: "curl --version"
      install_hint: "apt-get install curl"