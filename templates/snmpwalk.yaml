name: snmpwalk
description: SNMP enumeration with common community strings - system info, users, processes, network config
enabled: true

command:
  binary: bash
  args:
    - "-c"
    - |
      for community in public private manager; do
        echo "=== Testing community string: $community ===" >> {{output_dir}}/snmpwalk_results.txt
        timeout 30 snmpwalk -v 2c -c $community {{target}} 2>&1 >> {{output_dir}}/snmpwalk_results.txt || true
        if grep -q "Timeout: No Response" {{output_dir}}/snmpwalk_results.txt; then
          break
        fi
      done

depends_on: []

outputs:
  - pattern: "{{output_dir}}/snmpwalk_results.txt"

timeout: 120

env: {}

requires_sudo: false
