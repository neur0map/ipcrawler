metadata:
  name: "Chaining Test Profile"
  description: "naabu port discovery â†’ nmap detailed scan"
  version: "1.0"

tools:
  - name: "naabu_discovery"
    command: "naabu -host {target} -top-ports 1000 -o {output}/raw/discovered_ports.txt"
    timeout: 120
    output_file: "discovered_ports.txt"
    enabled: true
    
  - name: "nmap_targeted"
    command: "nmap -sV -sC -T4 {target} -p {discovered_ports} -oX {output}/raw/nmap_detailed.xml"
    timeout: 300
    output_file: "nmap_detailed.xml"
    enabled: true
    depends_on: "naabu_discovery"

chains:
  - name: "port_discovery_to_scan"
    from: "naabu_discovery"
    to: "nmap_targeted"
    condition: "has_output"
    
globals:
  max_concurrent: 2
  retry_count: 1
  log_level: "info"