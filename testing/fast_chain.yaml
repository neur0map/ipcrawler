metadata:
  name: "Fast Chaining Test"
  description: "Quick port scan â†’ targeted nmap"
  version: "1.0"

tools:
  - name: "naabu_fast"
    command: "naabu -host {target} -p 80,443,8080,8443 -o {output}/raw/discovered_ports.txt"
    timeout: 30
    output_file: "discovered_ports.txt"
    enabled: true
    
  - name: "nmap_targeted"
    command: "nmap -sV -sC -T4 {target} -p {discovered_ports} -oX {output}/raw/nmap_detailed.xml"
    timeout: 120
    output_file: "nmap_detailed.xml"
    enabled: true

chains:
  - name: "port_discovery_to_scan"
    from: "naabu_fast"
    to: "nmap_targeted"
    condition: "has_output"
    
globals:
  max_concurrent: 1
  retry_count: 1
  log_level: "info"