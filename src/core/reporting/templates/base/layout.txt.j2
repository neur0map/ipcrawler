{# Text Report Layout Template #}
{% block header -%}
{{ "=" * 80 }}
{% block title %}{{ metadata.generator | upper }} REPORT{% endblock %}
{{ "=" * 80 }}
Target: {{ data.target | default('Unknown') }}
Generated: {{ metadata.timestamp | format_datetime }}
Command: {{ data.command | default('N/A') }}
{% if data.duration -%}
Duration: {{ "%.2f"|format(data.duration) }} seconds
{% endif -%}
{% if data.total_hosts is defined -%}
Hosts: {{ data.total_hosts }} total, {{ data.up_hosts | default(0) }} up, {{ data.down_hosts | default(0) }} down
{% endif -%}
{{ "=" * 80 }}

{% endblock -%}

{% block content -%}
{# Human-readable content instead of JSON dump #}
{% if data -%}
SCAN RESULTS
{{ "-" * 80 }}

{% if data.hosts -%}
DISCOVERED HOSTS:
{% for host in data.hosts %}
Host: {{ host.address | default('Unknown') }}
{%- if host.hostname %}
  Hostname: {{ host.hostname }}
{%- endif %}
  Status: {{ host.status | default('unknown') | upper }}
{%- if host.ports %}
  Open Ports ({{ host.ports | length }}):
{%- for port in host.ports[:10] %}
    {{ port.port }}/{{ port.protocol | default('tcp') }} - {{ port.service | default('unknown') }} ({{ port.state | default('open') }})
{%- endfor %}
{%- if host.ports | length > 10 %}
    ... and {{ host.ports | length - 10 }} more ports
{%- endif %}
{%- endif %}

{% endfor %}
{% endif -%}

{%- if data.http_scan and data.http_scan.services %}
HTTP/HTTPS SERVICES:
{{ "-" * 40 }}
{% for service in data.http_scan.services %}
Service: {{ service.url | default('Unknown') }}
  Port: {{ service.port | default('N/A') }}
  Status: {{ service.status_code | default('N/A') }}
  Server: {{ service.server | default('Unknown') }}
{%- if service.title %}
  Title: {{ service.title }}
{%- endif %}
{%- if service.technologies %}
  Technologies: {{ service.technologies | join(', ') }}
{%- endif %}

{% endfor %}
{% endif -%}

{%- if data.mini_spider and data.mini_spider.discovered_urls %}
URL DISCOVERY:
{{ "-" * 40 }}
Discovered URLs: {{ data.mini_spider.discovered_urls | length }}
{%- if data.mini_spider.interesting_findings %}
Interesting Findings: {{ data.mini_spider.interesting_findings | length }}
{%- endif %}

{% endif -%}

{%- if data.smartlist and data.smartlist.wordlist_recommendations %}
WORDLIST RECOMMENDATIONS:
{{ "-" * 40 }}
{% for service_rec in data.smartlist.wordlist_recommendations %}
Service: {{ service_rec.service_name }} ({{ service_rec.service }})
  Port: {{ service_rec.port | default('N/A') }}
  Total Score: {{ service_rec.total_score }}
{%- if service_rec.top_wordlists %}
  Top Wordlists:
{%- for wordlist in service_rec.top_wordlists[:3] %}
    - {{ wordlist.wordlist }} (Score: {{ wordlist.score }}, Confidence: {{ wordlist.confidence }})
{%- endfor %}
{%- endif %}

{% endfor %}
{% endif -%}

{%- if data.summary %}
SUMMARY:
{{ "-" * 40 }}
{%- if data.summary.total_hosts is defined %}
Total Hosts: {{ data.summary.total_hosts }}
Up Hosts: {{ data.summary.up_hosts | default(0) }}
Down Hosts: {{ data.summary.down_hosts | default(0) }}
{%- endif %}
{%- if data.summary.http_services is defined %}
HTTP Services: {{ data.summary.http_services }}
{%- endif %}
{%- if data.summary.discovered_urls is defined %}
Discovered URLs: {{ data.summary.discovered_urls }}
{%- endif %}
{%- if data.duration %}
Scan Duration: {{ "%.2f"|format(data.duration) }} seconds
{%- endif %}
{% endif -%}
{% endif -%}
{% endblock -%}

{% block footer -%}

{{ "=" * 80 }}
Generated by {{ metadata.generator }} v{{ metadata.version }}
Template: {{ metadata.template }} | Theme: {{ theme.name }}
{{ "=" * 80 }}
{% endblock -%}