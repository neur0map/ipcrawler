<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ metadata.generator }}{% endblock %} - {{ data.target | default('Unknown Target') }}</title>
    
    {# CSS Styles #}
    <style>
        {% include 'themes/' + theme.name + '.css.j2' ignore missing %}
        {% block extra_styles %}{% endblock %}
    </style>
    
    {# Custom head content #}
    {% block head %}{% endblock %}
</head>
<body class="theme-{{ theme.name }}">
    <div class="container">
        {# Header Section #}
        <header class="header">
            {% block header %}
                <div class="header-content">
                    <h1 class="title">
                        {{ icons.search }} 
                        {% block header_title %}{{ metadata.generator }}{% endblock %}
                    </h1>
                    <div class="subtitle">
                        {% block header_subtitle %}
                            Target: <span class="target">{{ data.target | default('Unknown') }}</span>
                        {% endblock %}
                    </div>
                    <div class="meta">
                        {% block header_meta %}
                            Generated: {{ metadata.timestamp | format_datetime }} | 
                            {{ metadata.generator }} v{{ metadata.version }}
                        {% endblock %}
                    </div>
                </div>
            {% endblock %}
        </header>
        
        {# Main Content Area #}
        <main class="content">
            {% block content %}
                {# Default content if no specific content is provided #}
                <div class="section">
                    <div class="section-header">
                        {{ icons.info }} Report Data
                    </div>
                    <div class="section-content">
                        <pre class="json-data">{{ data | json_pretty }}</pre>
                    </div>
                </div>
            {% endblock %}
        </main>
        
        {# Footer Section #}
        <footer class="footer">
            {% block footer %}
                <div class="footer-content">
                    <p>
                        {{ icons.shield }} 
                        Generated by {{ metadata.generator }} - Advanced Network Discovery & Security Assessment Tool
                    </p>
                    <div class="footer-meta">
                        <span>Template: {{ metadata.template }}</span> |
                        <span>Theme: {{ theme.name }}</span> |
                        <span>Generated: {{ metadata.timestamp | format_datetime('%Y-%m-%d %H:%M:%S') }}</span>
                    </div>
                </div>
            {% endblock %}
        </footer>
    </div>
    
    {# JavaScript #}
    <script>
        {% block javascript %}
            // Default interactive functionality
            document.addEventListener('DOMContentLoaded', function() {
                // Collapsible sections
                const sectionHeaders = document.querySelectorAll('.section-header[data-collapsible]');
                sectionHeaders.forEach(header => {
                    header.style.cursor = 'pointer';
                    header.addEventListener('click', function() {
                        const content = this.nextElementSibling;
                        const isVisible = content.style.display !== 'none';
                        content.style.display = isVisible ? 'none' : 'block';
                        this.classList.toggle('collapsed', isVisible);
                    });
                });
                
                // Sortable tables
                const sortableTables = document.querySelectorAll('table[data-sortable]');
                sortableTables.forEach(table => {
                    const headers = table.querySelectorAll('th[data-sort]');
                    headers.forEach(header => {
                        header.style.cursor = 'pointer';
                        header.addEventListener('click', function() {
                            sortTable(table, this.dataset.sort);
                        });
                    });
                });
            });
            
            function sortTable(table, column) {
                // Basic table sorting implementation
                const tbody = table.querySelector('tbody');
                const rows = Array.from(tbody.querySelectorAll('tr'));
                const columnIndex = parseInt(column);
                
                rows.sort((a, b) => {
                    const aVal = a.cells[columnIndex].textContent.trim();
                    const bVal = b.cells[columnIndex].textContent.trim();
                    
                    // Try numeric sort first
                    const aNum = parseFloat(aVal);
                    const bNum = parseFloat(bVal);
                    if (!isNaN(aNum) && !isNaN(bNum)) {
                        return aNum - bNum;
                    }
                    
                    // Fall back to string sort
                    return aVal.localeCompare(bVal);
                });
                
                // Re-append sorted rows
                rows.forEach(row => tbody.appendChild(row));
            }
        {% endblock %}
    </script>
</body>
</html>