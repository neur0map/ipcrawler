name: "nmap"
description: "Comprehensive network port scanner and service detection"
command: "nmap -T4 -sV -sC {{target}} -p {{ports}}"
sudo_command: "nmap -T4 -sS -sV -sC -O -A --osscan-guess --version-intensity 9 {{target}} -p {{ports}}"
installer:
  apt: "apt install -y nmap"
  yum: "yum install -y nmap"
  dnf: "dnf install -y nmap"
  brew: "brew install nmap"
  pacman: "pacman -S --noconfirm nmap"
  zypper: "zypper install -y nmap"
timeout: 1800
output:
  type: "raw"
      port_capture: 1
    - name: "filtered_port"
      regex: '(\d+)/(tcp|udp)\s+filtered'
      severity: "low"
    - name: "service_version"
      regex: '(\d+)/(tcp|udp)\s+open\s+([^\s]+)\s+(.+)'
      severity: "info"
      port_capture: 1
    - name: "os_detection"
      regex: 'OS details: (.+)'
      severity: "medium"
      port_capture: 1
    - name: "os_cpe"
      regex: 'OS CPE: (cpe:[^\s]+)'
      severity: "info"
    - name: "hostname"
      regex: 'Nmap scan report for ([^\s]+) \('
      severity: "info"
    - name: "mac_address"
      regex: 'MAC Address: ([0-9A-F:]+) \(([^)]+)\)'
      severity: "info"
    - name: "script_result"
      regex: '\|[\s_-]+([^:]+):\s*(.+)'
      severity: "low"
    - name: "ssl_cert"
      regex: 'Subject: (.+)'
      severity: "info"
    - name: "ssh_hostkey"
      regex: '\|\s+(\d+)\s+([0-9A-Fa-f:]+)\s+\(([^)]+)\)'
      severity: "info"
    - name: "http_title"
      regex: '\|_http-title: (.+)'
      severity: "info"
    - name: "smb_os"
      regex: '\|[\s_]+OS: (.+)'
      severity: "medium"
    - name: "vulnerable_service"
      regex: '(ftp|telnet|rlogin|rsh)\s+open'
      severity: "high"
    - name: "nse_script_output"
      regex: '\|[_\s]+([a-zA-Z0-9_-]+):'
      severity: "low"
    - name: "warning_message"
      regex: 'Warning: (.+)'
      severity: "medium"
    - name: "general_finding"
      regex: '^(\d+/\w+.+)'
      severity: "info"
