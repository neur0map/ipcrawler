name: "nmap"
description: "Port scanner and service detection"
command: "nmap -sV -sC {{target}} -p {{port}} -oX {{output_file}}"
installer:
  apt: "apt install -y nmap"
  yum: "yum install -y nmap"
  dnf: "dnf install -y nmap"
  brew: "brew install nmap"
  pacman: "pacman -S --noconfirm nmap"
  zypper: "zypper install -y nmap"
timeout: 600
output:
  type: "xml"
  patterns:
    - name: "open_port"
      regex: 'port protocol="tcp" portid="(\d+)"><state state="open"'
      severity: "info"
    - name: "service_detected"
      regex: 'service name="([^"]+)".*product="([^"]*)".*version="([^"]*)"'
      severity: "info"
