name: "sqlmap"
description: "Advanced SQL injection testing tool"
command: "sqlmap -u http://{{target}}:{{port}} --batch --random-agent --level=3 --risk=2 --threads=5 --tamper=space2comment,between,randomcase --output-dir={{output_file}}"
sudo_command: "sqlmap -u http://{{target}}:{{port}} --batch --random-agent --level=5 --risk=3 --threads=10 --tamper=space2comment,between,randomcase,charencode,unicodeescape --os-pwn --priv-esc --output-dir={{output_file}}"
installer:
  apt: "apt install -y sqlmap"
  yum: "yum install -y sqlmap"
  dnf: "dnf install -y sqlmap"
  brew: "brew install sqlmap"
  pacman: "pacman -S --noconfirm sqlmap"
  zypper: "zypper install -y sqlmap"
timeout: 2400
output:
  type: "regex"
  patterns:
    - name: "sql_injection"
      regex: 'Parameter: (\w+) \(.*?\) is vulnerable'
      severity: "critical"
    - name: "database_identified"
      regex: 'back-end DBMS: (.+)'
      severity: "high"
    - name: "injection_type"
      regex: 'Type: (.+)'
      severity: "high"
    - name: "sql_payload"
      regex: 'Payload: (.+)'
      severity: "high"
    - name: "database_dump"
      regex: 'Database: (.+)'
      severity: "critical"
    - name: "table_found"
      regex: 'Table: (.+)'
      severity: "high"
    - name: "column_found"
      regex: 'Column: (.+)'
      severity: "high"
    - name: "credentials_found"
      regex: '(?:password|passwd|pwd|user|login|auth)[^\s]*[:=]\s*[^\s]+'
      severity: "critical"